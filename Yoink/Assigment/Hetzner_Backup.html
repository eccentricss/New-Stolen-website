<html><head>
    <title>Hetzner Backup Solution</title>
    <style>
        body { font-family: Arial; padding: 20px; max-width: 900px; margin: 0 auto; }
        .code-block { background: #2d3748; color: white; padding: 20px; border-radius: 8px; margin: 15px 0; }
        .step { background: #f0fff4; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #38a169; }
        .warning { background: #fed7d7; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #e53e3e; }
        .language-section { border-left: 4px solid #4299e1; padding-left: 15px; margin: 20px 0; }
        h1 { color: #2d3748; }
        h2 { color: #4a5568; margin-top: 30px; }
        .swedish { color: #2b6cb0; }
        .english { color: #744210; }
    </style>
</head>
<body>
    <h1>ğŸ’¾ Task 01 - Hetzner Backup Solution</h1>
    
    <div class="language-section">
        <h3 class="english">ğŸ‡¬ğŸ‡§ Complete technical procedure for creating alienable backups of Hetzner cloud servers</h3>
        <h3 class="swedish">ğŸ‡¸ğŸ‡ª Komplett teknisk procedur fÃ¶r att skapa Ã¶verfÃ¶rbara sÃ¤kerhetskopior av Hetzner-molnservrar</h3>
    </div>

    <h2>ğŸ¯ Solution Overview / LÃ¶sningsÃ¶versikt</h2>
    
    <div class="language-section">
        <h3 class="english">ğŸ‡¬ğŸ‡§ Problem Statement:</h3>
        <p>Hetzner's native backups are locked to their platform. We need a way to create downloadable server images that can be restored on local VirtualBox instances.</p>
    </div>
    
    <div class="language-section">
        <h3 class="swedish">ğŸ‡¸ğŸ‡ª Problembeskrivning:</h3>
        <p>Hetzners egna sÃ¤kerhetskopior Ã¤r lÃ¥sta till deras plattform. Vi behÃ¶ver ett sÃ¤tt att skapa nedladdningsbara serveravbildningar som kan Ã¥terstÃ¤llas pÃ¥ lokala VirtualBox-instanser.</p>
    </div>

    <h2>ğŸ”§ Complete Backup Script / Komplett SÃ¤kerhetskopieringsskript</h2>
    
    <div class="code-block">
        <div class="language-section">
            <h3 class="english">ğŸ‡¬ğŸ‡§ Backup Script (run on Hetzner server):</h3>
            <pre><code>
#!/bin/bash
# hetzner-backup.sh
# Complete server backup solution for Hetzner Cloud

BACKUP_DIR="/backup"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="hetzner_backup_$TIMESTAMP.img"
LOG_FILE="$BACKUP_DIR/backup_$TIMESTAMP.log"

echo "ğŸš€ Starting Hetzner server backup - $(date)" | tee -a $LOG_FILE

# Create backup directory
mkdir -p $BACKUP_DIR

# Check disk space
AVAILABLE_SPACE=$(df / | awk 'NR==2 {print $4}')
REQUIRED_SPACE=20000000  # 20GB minimum

if [ $AVAILABLE_SPACE -lt $REQUIRED_SPACE ]; then
    echo "âŒ Error: Insufficient disk space. Need at least 20GB free." | tee -a $LOG_FILE
    exit 1
fi

echo "ğŸ’¾ Creating disk image using dd..." | tee -a $LOG_FILE

# Create raw disk image (adjust /dev/sda to your main disk)
dd if=/dev/sda of=$BACKUP_DIR/$BACKUP_FILE bs=4M status=progress 2&gt;&amp;1 | tee -a $LOG_FILE

# Verify backup was created
if [ ! -f "$BACKUP_DIR/$BACKUP_FILE" ]; then
    echo "âŒ Error: Backup file was not created" | tee -a $LOG_FILE
    exit 1
fi

echo "ğŸ“¦ Compressing backup..." | tee -a $LOG_FILE

# Compress the backup to reduce size
gzip $BACKUP_DIR/$BACKUP_FILE

# Create checksum for verification
echo "ğŸ” Creating verification checksum..." | tee -a $LOG_FILE
md5sum $BACKUP_DIR/${BACKUP_FILE}.gz &gt; $BACKUP_DIR/${BACKUP_FILE}.gz.md5

# Display backup information
BACKUP_SIZE=$(du -h $BACKUP_DIR/${BACKUP_FILE}.gz | cut -f1)
echo "âœ… Backup completed successfully!" | tee -a $LOG_FILE
echo "ğŸ“ Backup file: $BACKUP_DIR/${BACKUP_FILE}.gz" | tee -a $LOG_FILE
echo "ğŸ’¿ Backup size: $BACKUP_SIZE" | tee -a $LOG_FILE
echo "ğŸ”¢ MD5 checksum: $(cat $BACKUP_DIR/${BACKUP_FILE}.gz.md5)" | tee -a $LOG_FILE

echo "ğŸ‰ Backup process finished - $(date)" | tee -a $LOG_FILE
            </code></pre>
        </div>
        
        <div class="language-section">
            <h3 class="swedish">ğŸ‡¸ğŸ‡ª SÃ¤kerhetskopieringsskript (kÃ¶r pÃ¥ Hetzner-server):</h3>
            <pre><code>
#!/bin/bash
# hetzner-backup.sh
# Komplett serverbackup-lÃ¶sning fÃ¶r Hetzner Cloud

BACKUP_DIR="/backup"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="hetzner_backup_$TIMESTAMP.img"
LOG_FILE="$BACKUP_DIR/backup_$TIMESTAMP.log"

echo "ğŸš€ Startar Hetzner serverbackup - $(date)" | tee -a $LOG_FILE

# Skapa backup-katalog
mkdir -p $BACKUP_DIR

# Kontrollera diskutrymme
LEDIGT_UTRYMME=$(df / | awk 'NR==2 {print $4}')
KRÃ„VT_UTRYMME=20000000  # 20GB minimum

if [ $LEDIGT_UTRYMME -lt $KRÃ„VT_UTRYMME ]; then
    echo "âŒ Fel: OtillrÃ¤ckligt diskutrymme. BehÃ¶ver minst 20GB ledigt." | tee -a $LOG_FILE
    exit 1
fi

echo "ğŸ’¾ Skapar diskavbildning med dd..." | tee -a $LOG_FILE

# Skapa rÃ¥ diskavbildning (justera /dev/sda till din huvuddisk)
dd if=/dev/sda of=$BACKUP_DIR/$BACKUP_FILE bs=4M status=progress 2&gt;&amp;1 | tee -a $LOG_FILE

# Verifiera att backup skapades
if [ ! -f "$BACKUP_DIR/$BACKUP_FILE" ]; then
    echo "âŒ Fel: Backup-filen skapades inte" | tee -a $LOG_FILE
    exit 1
fi

echo "ğŸ“¦ Komprimerar backup..." | tee -a $LOG_FILE

# Komprimera backupen fÃ¶r att minska storlek
gzip $BACKUP_DIR/$BACKUP_FILE

# Skapa checksumma fÃ¶r verifiering
echo "ğŸ” Skapar verifierings-checksumma..." | tee -a $LOG_FILE
md5sum $BACKUP_DIR/${BACKUP_FILE}.gz &gt; $BACKUP_DIR/${BACKUP_FILE}.gz.md5

# Visa backup-information
BACKUP_STORLEK=$(du -h $BACKUP_DIR/${BACKUP_FILE}.gz | cut -f1)
echo "âœ… Backup slutfÃ¶rd framgÃ¥ngsrikt!" | tee -a $LOG_FILE
echo "ğŸ“ Backup-fil: $BACKUP_DIR/${BACKUP_FILE}.gz" | tee -a $LOG_FILE
echo "ğŸ’¿ Backup-storlek: $BACKUP_STORLEK" | tee -a $LOG_FILE
echo "ğŸ”¢ MD5 checksumma: $(cat $BACKUP_DIR/${BACKUP_FILE}.gz.md5)" | tee -a $LOG_FILE

echo "ğŸ‰ Backup-process avslutad - $(date)" | tee -a $LOG_FILE
            </code></pre>
        </div>
    </div>

    <h2>ğŸ”„ Restore Script / Ã…terstÃ¤llningsskript</h2>
    
    <div class="code-block">
        <div class="language-section">
            <h3 class="english">ğŸ‡¬ğŸ‡§ Restore Script (run on local machine):</h3>
            <pre><code>
#!/bin/bash
# restore-to-virtualbox.sh
# Restore Hetzner backup to VirtualBox VM

if [ $# -eq 0 ]; then
    echo "âŒ Usage: $0 <backup_file.img.gz>"
    echo "   Example: $0 hetzner_backup_20241126_0200.img.gz"
    exit 1
fi

BACKUP_FILE=$1
VM_NAME="hetzner-restored-$(date +%Y%m%d)"
EXTRACTED_IMG="restored_disk.img"

echo "ğŸ”„ Restoring Hetzner backup to VirtualBox..."

# Verify backup file exists
if [ ! -f "$BACKUP_FILE" ]; then
    echo "âŒ Error: Backup file '$BACKUP_FILE' not found"
    exit 1
fi

# Verify checksum if available
if [ -f "${BACKUP_FILE}.md5" ]; then
    echo "ğŸ” Verifying backup integrity..."
    md5sum -c "${BACKUP_FILE}.md5"
    if [ $? -ne 0 ]; then
        echo "âŒ Error: Backup file verification failed"
        exit 1
    fi
    echo "âœ… Backup verification successful"
fi

echo "ğŸ“¦ Extracting backup file..."
gunzip -c "$BACKUP_FILE" &gt; "$EXTRACTED_IMG"

echo "ğŸ–¥ï¸ Creating VirtualBox VM..."
# Create virtual machine
VBoxManage createvm --name "$VM_NAME" --ostype "Ubuntu_64" --register

# Create virtual disk
VBoxManage createmedium disk --filename "$VM_NAME.vdi" --format VDI --variant Fixed

echo "ğŸ’¾ Converting disk image to VirtualBox format..."
# Convert raw image to VDI format
VBoxManage convertfromraw "$EXTRACTED_IMG" "$VM_NAME.vdi" --format VDI

echo "âš™ï¸ Configuring VM settings..."
# Configure VM hardware
VBoxManage modifyvm "$VM_NAME" --memory 2048 --cpus 2 --acpi on --boot1 disk --boot2 none --boot3 none --boot4 none

# Add storage controller
VBoxManage storagectl "$VM_NAME" --name "SATA Controller" --add sata --controller IntelAHCI

# Attach disk
VBoxManage storageattach "$VM_NAME" --storagectl "SATA Controller" --port 0 --device 0 --type hdd --medium "$VM_NAME.vdi"

# Enable network adapter (NAT for internet access)
VBoxManage modifyvm "$VM_NAME" --nic1 nat

echo "âœ… VirtualBox VM created successfully!"
echo "ğŸ–¥ï¸ VM Name: $VM_NAME"
echo "ğŸ’¿ Disk: $VM_NAME.vdi"
echo "ğŸ¯ Start VM with: VBoxManage startvm \"$VM_NAME\""

# Clean up temporary file
rm -f "$EXTRACTED_IMG"

echo "ğŸš€ Restoration complete! You can now start the VirtualBox VM."
            </backup_file.img.gz></code></pre>
        </div>
        
        <div class="language-section">
            <h3 class="swedish">ğŸ‡¸ğŸ‡ª Ã…terstÃ¤llningsskript (kÃ¶r pÃ¥ lokal maskin):</h3>
            <pre><code>
#!/bin/bash
# restore-to-virtualbox.sh
# Ã…terstÃ¤ll Hetzner-backup till VirtualBox VM

if [ $# -eq 0 ]; then
    echo "âŒ AnvÃ¤ndning: $0 <backup_file.img.gz>"
    echo "   Exempel: $0 hetzner_backup_20241126_0200.img.gz"
    exit 1
fi

BACKUP_FILE=$1
VM_NAME="hetzner-restored-$(date +%Y%m%d)"
EXTRAHERAD_IMG="restored_disk.img"

echo "ğŸ”„ Ã…terstÃ¤ller Hetzner-backup till VirtualBox..."

# Verifiera att backup-filen finns
if [ ! -f "$BACKUP_FILE" ]; then
    echo "âŒ Fel: Backup-filen '$BACKUP_FILE' hittades inte"
    exit 1
fi

# Verifiera checksumma om tillgÃ¤nglig
if [ -f "${BACKUP_FILE}.md5" ]; then
    echo "ğŸ” Verifierar backup-integritet..."
    md5sum -c "${BACKUP_FILE}.md5"
    if [ $? -ne 0 ]; then
        echo "âŒ Fel: Backup-fil verifiering misslyckades"
        exit 1
    fi
    echo "âœ… Backup-verifiering lyckades"
fi

echo "ğŸ“¦ Extraherar backup-fil..."
gunzip -c "$BACKUP_FILE" &gt; "$EXTRAHERAD_IMG"

echo "ğŸ–¥ï¸ Skapar VirtualBox VM..."
# Skapa virtuell maskin
VBoxManage createvm --name "$VM_NAME" --ostype "Ubuntu_64" --register

# Skapa virtuell disk
VBoxManage createmedium disk --filename "$VM_NAME.vdi" --format VDI --variant Fixed

echo "ğŸ’¾ Konverterar diskavbildning till VirtualBox-format..."
# Konvertera rÃ¥ avbildning till VDI-format
VBoxManage convertfromraw "$EXTRAHERAD_IMG" "$VM_NAME.vdi" --format VDI

echo "âš™ï¸ Konfigurerar VM-instÃ¤llningar..."
# Konfigurera VM-hÃ¥rdvara
VBoxManage modifyvm "$VM_NAME" --memory 2048 --cpus 2 --acpi on --boot1 disk --boot2 none --boot3 none --boot4 none

# LÃ¤gg till lagringskontroller
VBoxManage storagectl "$VM_NAME" --name "SATA Controller" --add sata --controller IntelAHCI

# Koppla disk
VBoxManage storageattach "$VM_NAME" --storagectl "SATA Controller" --port 0 --device 0 --type hdd --medium "$VM_NAME.vdi"

# Aktivera nÃ¤tverksadapter (NAT fÃ¶r internetÃ¥tkomst)
VBoxManage modifyvm "$VM_NAME" --nic1 nat

echo "âœ… VirtualBox VM skapad framgÃ¥ngsrikt!"
echo "ğŸ–¥ï¸ VM Namn: $VM_NAME"
echo "ğŸ’¿ Disk: $VM_NAME.vdi"
echo "ğŸ¯ Starta VM med: VBoxManage startvm \"$VM_NAME\""

# Rensa temporÃ¤r fil
rm -f "$EXTRAHERAD_IMG"

echo "ğŸš€ Ã…terstÃ¤llning slutfÃ¶rd! Du kan nu starta VirtualBox VM."
            </backup_file.img.gz></code></pre>
        </div>
    </div>

    <h2>ğŸ“‹ Step-by-Step Guide / Steg-fÃ¶r-steg Guide</h2>
    
    <div class="step">
        <h3 class="english">ğŸ‡¬ğŸ‡§ Step 1: Create Backup on Hetzner Server</h3>
        <ol>
            <li>SSH into your Hetzner server: <code>ssh root@your-server-ip</code></li>
            <li>Download the backup script: <code>wget https://raw.githubusercontent.com/your-repo/hetzner-backup.sh</code></li>
            <li>Make it executable: <code>chmod +x hetzner-backup.sh</code></li>
            <li>Run the backup: <code>./hetzner-backup.sh</code></li>
            <li>Wait for completion (this may take 30-60 minutes)</li>
        </ol>
        
        <h3 class="swedish">ğŸ‡¸ğŸ‡ª Steg 1: Skapa Backup pÃ¥ Hetzner Server</h3>
        <ol>
            <li>SSH in i din Hetzner-server: <code>ssh root@din-server-ip</code></li>
            <li>Ladda ner backup-skriptet: <code>wget https://raw.githubusercontent.com/ditt-repo/hetzner-backup.sh</code></li>
            <li>GÃ¶r den kÃ¶rbar: <code>chmod +x hetzner-backup.sh</code></li>
            <li>KÃ¶r backupen: <code>./hetzner-backup.sh</code></li>
            <li>VÃ¤nta pÃ¥ slutfÃ¶rande (kan ta 30-60 minuter)</li>
        </ol>
    </div>

    <div class="step">
        <h3 class="english">ğŸ‡¬ğŸ‡§ Step 2: Download Backup File</h3>
        <ol>
            <li>Use SCP to download: <code>scp root@your-server-ip:/backup/*.img.gz .</code></li>
            <li>Also download the checksum file: <code>scp root@your-server-ip:/backup/*.md5 .</code></li>
            <li>Verify file integrity: <code>md5sum -c *.md5</code></li>
        </ol>
        
        <h3 class="swedish">ğŸ‡¸ğŸ‡ª Steg 2: Ladda Ner Backup-fil</h3>
        <ol>
            <li>AnvÃ¤nd SCP fÃ¶r att ladda ner: <code>scp root@din-server-ip:/backup/*.img.gz .</code></li>
            <li>Ladda ner Ã¤ven checksumma-filen: <code>scp root@din-server-ip:/backup/*.md5 .</code></li>
            <li>Verifiera filintegritet: <code>md5sum -c *.md5</code></li>
        </ol>
    </div>

    <div class="step">
        <h3 class="english">ğŸ‡¬ğŸ‡§ Step 3: Restore to VirtualBox</h3>
        <ol>
            <li>Ensure VirtualBox is installed on your local machine</li>
            <li>Download the restore script</li>
            <li>Run: <code>./restore-to-virtualbox.sh your-backup-file.img.gz</code></li>
            <li>Start the VM: <code>VBoxManage startvm "hetzner-restored-20241126"</code></li>
        </ol>
        
        <h3 class="swedish">ğŸ‡¸ğŸ‡ª Steg 3: Ã…terstÃ¤ll till VirtualBox</h3>
        <ol>
            <li>Se till att VirtualBox Ã¤r installerat pÃ¥ din lokala maskin</li>
            <li>Ladda ner Ã¥terstÃ¤llningsskriptet</li>
            <li>KÃ¶r: <code>./restore-to-virtualbox.sh din-backup-fil.img.gz</code></li>
            <li>Starta VM: <code>VBoxManage startvm "hetzner-restored-20241126"</code></li>
        </ol>
    </div>

    <div class="warning">
        <h3 class="english">ğŸ‡¬ğŸ‡§ âš ï¸ Important Notes:</h3>
        <ul>
            <li>Backup files can be very large (10GB+)</li>
            <li>Ensure you have enough disk space on both Hetzner server and local machine</li>
            <li>The backup process will temporarily increase server load</li>
            <li>Test the restoration process before relying on it for production</li>
        </ul>
        
        <h3 class="swedish">ğŸ‡¸ğŸ‡ª âš ï¸ Viktiga AnmÃ¤rkningar:</h3>
        <ul>
            <li>Backup-filer kan vara mycket stora (10GB+)</li>
            <li>Se till att du har tillrÃ¤ckligt med diskutrymme pÃ¥ bÃ¥de Hetzner-server och lokal maskin</li>
            <li>Backup-processen kommer temporÃ¤rt Ã¶ka serverbelastningen</li>
            <li>Testa Ã¥terstÃ¤llningsprocessen innan du litar pÃ¥ den fÃ¶r produktion</li>
        </ul>
    </div>

    <h2>ğŸ“ Technical Learning / Tekniskt LÃ¤rande</h2>
    
    <div class="language-section">
        <h3 class="english">ğŸ‡¬ğŸ‡§ Skills Developed:</h3>
        <ul>
            <li>Disk imaging and backup strategies</li>
            <li>Linux system administration</li>
            <li>VirtualBox VM management</li>
            <li>Bash scripting and automation</li>
            <li>Cross-platform compatibility solutions</li>
        </ul>
        
        <h3 class="swedish">ğŸ‡¸ğŸ‡ª Utvecklade FÃ¤rdigheter:</h3>
        <ul>
            <li>Diskavbildning och backup-strategier</li>
            <li>Linux-systemadministration</li>
            <li>VirtualBox VM-hantering</li>
            <li>Bash-skriptning och automatisering</li>
            <li>LÃ¶sningar fÃ¶r plattformsoberoende kompatibilitet</li>
        </ul>
    </div>

    <a href="../index.html" style="display: inline-block; margin-top: 20px; padding: 10px 20px; background: #4299e1; color: white; text-decoration: none; border-radius: 5px;">â† Back to Portfolio / Tillbaka till Portfolio</a>


</body></html>